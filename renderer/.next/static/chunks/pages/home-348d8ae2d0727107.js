(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{4378:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return s(5817)}])},5817:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var c=s(4246),a=s(1147),r=s.n(a),n=s(7378),l=s(8038),o=s.n(l),i=s(5353),f=s(6034);let b={apiKey:"AIzaSyCsc1H_-gAx-zz57tchkgl9IkmorJN-Vy4",authDomain:"coocon-pang.firebaseapp.com",databaseURL:"https://coocon-pang-default-rtdb.firebaseio.com",projectId:"coocon-pang",storageBucket:"coocon-pang.firebasestorage.app",messagingSenderId:"444871641277",appId:"1:444871641277:web:1845975485049218ff0fd4"},x=(0,i.C6)().length?(0,i.Mq)():(0,i.ZF)(b);b.databaseURL||console.error("Firebase Database URL is missing! Check your .env file.");let d=(0,f.N8)(x);function m(){let[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[l,i]=(0,n.useState)(!1),[b,x]=(0,n.useState)("동료님"),[m,u]=(0,n.useState)([]),[g]=(0,n.useState)(Date.now());(0,n.useEffect)(()=>{try{let e=localStorage.getItem("coocon-pang-nickname");e&&a(e)}catch(e){console.error(e)}(async()=>{try{let e=await window.ipc.invoke("get-username");e&&x(e)}catch(e){console.error("Failed to get username",e)}})(),(async()=>{try{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),s=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999).getTime(),c=(0,f.iH)(d,"pang_events"),a=(0,f.IO)(c,(0,f.g2)("timestamp"),(0,f.e0)(t),(0,f.Wu)(s),(0,f.vh)(50)),r=await (0,f.U2)(a);if(r.exists()){let e=r.val();if(e){let t=Object.values(e).sort((e,t)=>t.timestamp-e.timestamp);u(t)}}}catch(e){console.error("History load error:",e)}})();let e=(0,f.iH)(d,"pang_events"),t=(0,f.yv)(e,e=>{try{let t=e.val();if(t){t.timestamp&&t.timestamp>g&&window.ipc.send("trigger-pang",t);let e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime();t.timestamp>=s&&u(e=>e.find(e=>e.timestamp===t.timestamp)?e:[t,...e].sort((e,t)=>t.timestamp-e.timestamp))}}catch(e){console.error(e)}});return()=>t()},[]);let p=async()=>{if(e.trim()){!l&&s.trim()&&localStorage.setItem("coocon-pang-nickname",s);try{let c=(0,f.iH)(d,"pang_events");await (0,f.VF)(c,{text:e,sender:l?"익명의 요정":"".concat(s||"익명","(").concat(b,")"),isAnonymous:l,timestamp:(0,f.Bt)()}),t(""),window.ipc.send("hide-sender",null)}catch(e){console.error("Error sending message:",e)}}},h=e=>e?new Date(e).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1}):"";return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(o(),{children:(0,c.jsx)("title",{className:"jsx-ffc93fb3c50c041b",children:"쿠콘팡 - 메시지 보내기"})}),(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex flex-col h-screen bg-[#F7F9FC] border-2 border-[#00479B] p-4 rounded-lg overflow-hidden shadow-2xl",children:[(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex justify-between items-center mb-3",children:[(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex items-center gap-2",children:[(0,c.jsx)("img",{src:"/images/logo-icon.png",alt:"Logo",className:"jsx-ffc93fb3c50c041b w-6 h-6"}),(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b font-bold text-[#00479B]",children:"쿠콘팡! 소식 쏘기"})]}),(0,c.jsx)("button",{onClick:()=>window.ipc.send("hide-sender",null),title:"창 닫기 (Esc)",className:"jsx-ffc93fb3c50c041b w-6 h-6 flex items-center justify-center rounded-full hover:bg-gray-200 text-gray-400 transition-colors",children:"✕"})]}),(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex items-center gap-2 mb-3",children:[(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b text-xs font-semibold text-gray-500 w-12 shrink-0",children:"보내는 이"}),(0,c.jsx)("input",{type:"text",placeholder:"이름 입력 (예: 홍길동)",value:s,onChange:e=>a(e.target.value),disabled:l,className:"jsx-ffc93fb3c50c041b flex-1 px-3 py-1.5 border border-gray-200 rounded text-sm focus:outline-none focus:ring-1 focus:ring-[#36A3D1] text-gray-900 bg-white"}),(0,c.jsxs)("span",{className:"jsx-ffc93fb3c50c041b text-[10px] text-gray-400 shrink-0",children:["(",b,")"]})]}),(0,c.jsx)("textarea",{autoFocus:!0,placeholder:l?"익명의 요정이 되어 소식을 전해보세요!":"나누고 싶은 기쁜 소식을 적어주세요! (최대 50자)",maxLength:50,value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),p()),"Escape"===e.key&&window.ipc.send("hide-sender",null)},className:"jsx-ffc93fb3c50c041b "+"h-28 w-full p-3 border rounded-md focus:outline-none focus:ring-2 transition-all resize-none text-sm text-gray-900 bg-white shadow-inner ".concat(l?"border-purple-300 focus:ring-purple-400":"border-gray-200 focus:ring-[#36A3D1]")}),(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex justify-between items-center mt-3 mb-4",children:[(0,c.jsxs)("label",{className:"jsx-ffc93fb3c50c041b flex items-center gap-2 cursor-pointer text-xs text-gray-600 select-none",children:[(0,c.jsx)("input",{type:"checkbox",checked:l,onChange:e=>i(e.target.checked),className:"jsx-ffc93fb3c50c041b accent-purple-500 w-4 h-4"}),"익명으로 쏘기"]}),(0,c.jsx)("button",{onClick:p,style:{backgroundColor:l?"#9333ea":"#00479B",color:"#ffffff",display:"inline-block",width:"auto",minWidth:"120px"},className:"jsx-ffc93fb3c50c041b px-8 py-2 rounded-md font-bold text-sm transition-all shadow-md active:scale-95 text-white",children:l?"비밀스럽게 팡! \uD83E\uDDDA":"팡! 발사 \uD83D\uDE80"})]}),(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex-1 flex flex-col min-h-0 border-t border-gray-200 pt-3",children:[(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex items-center justify-between mb-2",children:[(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b text-xs font-bold text-[#00479B]",children:"\uD83D\uDCCD 오늘의 소식 이력"}),(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b text-[10px] text-gray-400",children:"당일 소식만 표시"})]}),(0,c.jsx)("div",{className:"jsx-ffc93fb3c50c041b flex-1 overflow-y-auto pr-1 custom-scrollbar",children:m.length>0?m.map((e,t)=>(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b mb-2 p-2.5 bg-white rounded border border-gray-100 shadow-sm flex flex-col gap-1.5 transition-all hover:border-[#36A3D1]",children:[(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b flex justify-between items-center",children:[(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b "+"text-[10px] font-bold ".concat(e.isAnonymous?"text-purple-500":"text-[#00479B]"),children:e.sender}),(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b text-[9px] text-gray-400",children:h(e.timestamp)})]}),(0,c.jsx)("p",{className:"jsx-ffc93fb3c50c041b text-xs text-gray-700 leading-relaxed break-words",children:e.text})]},t)):(0,c.jsxs)("div",{className:"jsx-ffc93fb3c50c041b h-full flex flex-col items-center justify-center py-8 opacity-40",children:[(0,c.jsx)("img",{src:"/images/logo-icon.png",alt:"empty",className:"jsx-ffc93fb3c50c041b w-8 h-8 mb-2 grayscale"}),(0,c.jsx)("span",{className:"jsx-ffc93fb3c50c041b text-[11px] text-gray-500",children:"오늘의 첫 소식을 기다리고 있어요!"})]})})]})]}),(0,c.jsx)(r(),{id:"ffc93fb3c50c041b",children:".custom-scrollbar.jsx-ffc93fb3c50c041b::-webkit-scrollbar{width:5px}.custom-scrollbar.jsx-ffc93fb3c50c041b::-webkit-scrollbar-track{background:transparent}.custom-scrollbar.jsx-ffc93fb3c50c041b::-webkit-scrollbar-thumb{background:#cbd5e1;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}.custom-scrollbar.jsx-ffc93fb3c50c041b::-webkit-scrollbar-thumb:hover{background:#94a3b8}.shrink-0.jsx-ffc93fb3c50c041b{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}"})]})}}},function(e){e.O(0,[701,745,888,774,179],function(){return e(e.s=4378)}),_N_E=e.O()}]);